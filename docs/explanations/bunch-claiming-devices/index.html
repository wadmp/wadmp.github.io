<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Bunch Claiming Devices | WebAccess/DMP Documentation</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="Open-source documentation for users of Advantech&amp;#39;s WebAccess/DMP software">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/assets/css/0.styles.b7937dc8.css" as="style"><link rel="preload" href="/assets/js/app.4d4f93c9.js" as="script"><link rel="preload" href="/assets/js/2.8d7a74f5.js" as="script"><link rel="preload" href="/assets/js/12.4f642c83.js" as="script"><link rel="preload" href="/assets/js/28.3842130a.js" as="script"><link rel="prefetch" href="/assets/js/10.8ffd4065.js"><link rel="prefetch" href="/assets/js/11.8ac7687f.js"><link rel="prefetch" href="/assets/js/13.d5a82f61.js"><link rel="prefetch" href="/assets/js/14.f8ec5e8c.js"><link rel="prefetch" href="/assets/js/15.c3dd21eb.js"><link rel="prefetch" href="/assets/js/16.3902d074.js"><link rel="prefetch" href="/assets/js/17.9a8b9956.js"><link rel="prefetch" href="/assets/js/18.83c89214.js"><link rel="prefetch" href="/assets/js/19.48bfa372.js"><link rel="prefetch" href="/assets/js/20.9a4bfdab.js"><link rel="prefetch" href="/assets/js/21.f8b55376.js"><link rel="prefetch" href="/assets/js/22.ef323635.js"><link rel="prefetch" href="/assets/js/23.aa334f07.js"><link rel="prefetch" href="/assets/js/24.e385b14d.js"><link rel="prefetch" href="/assets/js/25.77767816.js"><link rel="prefetch" href="/assets/js/26.a54aec8c.js"><link rel="prefetch" href="/assets/js/27.805e3a82.js"><link rel="prefetch" href="/assets/js/29.96733ab4.js"><link rel="prefetch" href="/assets/js/3.7ae8f4e8.js"><link rel="prefetch" href="/assets/js/30.05fac5a0.js"><link rel="prefetch" href="/assets/js/31.39623f66.js"><link rel="prefetch" href="/assets/js/32.ad044c6a.js"><link rel="prefetch" href="/assets/js/33.578c4b48.js"><link rel="prefetch" href="/assets/js/34.2eef0cdc.js"><link rel="prefetch" href="/assets/js/35.ea4b9167.js"><link rel="prefetch" href="/assets/js/36.9c9e3885.js"><link rel="prefetch" href="/assets/js/37.9d03a62a.js"><link rel="prefetch" href="/assets/js/38.01bce2f1.js"><link rel="prefetch" href="/assets/js/39.aa125f69.js"><link rel="prefetch" href="/assets/js/4.c8398e6d.js"><link rel="prefetch" href="/assets/js/40.941be774.js"><link rel="prefetch" href="/assets/js/41.9e5668d7.js"><link rel="prefetch" href="/assets/js/42.8fea2e01.js"><link rel="prefetch" href="/assets/js/43.0a2a81ff.js"><link rel="prefetch" href="/assets/js/44.1a6b6010.js"><link rel="prefetch" href="/assets/js/45.0cb6788b.js"><link rel="prefetch" href="/assets/js/46.c2de88f2.js"><link rel="prefetch" href="/assets/js/47.877d7505.js"><link rel="prefetch" href="/assets/js/48.370a3fca.js"><link rel="prefetch" href="/assets/js/49.651dfebe.js"><link rel="prefetch" href="/assets/js/5.8d51c0e8.js"><link rel="prefetch" href="/assets/js/50.66d7a19c.js"><link rel="prefetch" href="/assets/js/51.faf5291f.js"><link rel="prefetch" href="/assets/js/52.eff5052e.js"><link rel="prefetch" href="/assets/js/53.48cb6c2e.js"><link rel="prefetch" href="/assets/js/6.3686941e.js"><link rel="prefetch" href="/assets/js/7.3b779b81.js"><link rel="prefetch" href="/assets/js/8.ed0277b2.js"><link rel="prefetch" href="/assets/js/9.b763b7fb.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b7937dc8.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo.png" alt="WebAccess/DMP Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tutorials/" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><a href="/explanations/" class="nav-link router-link-active">
  Explanations
</a></div><div class="nav-item"><a href="/release-notes/" class="nav-link">
  Release Notes
</a></div><div class="nav-item"><a href="/client/" class="nav-link">
  Client Release Notes
</a></div><div class="nav-item"><a href="/contact/" class="nav-link">
  Support &amp; Contact
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tutorials/" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><a href="/explanations/" class="nav-link router-link-active">
  Explanations
</a></div><div class="nav-item"><a href="/release-notes/" class="nav-link">
  Release Notes
</a></div><div class="nav-item"><a href="/client/" class="nav-link">
  Client Release Notes
</a></div><div class="nav-item"><a href="/contact/" class="nav-link">
  Support &amp; Contact
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/explanations/" aria-current="page" class="sidebar-link">Device Desired and Reported states</a></li><li><a href="/explanations/companies-and-users/" class="sidebar-link">Companies and Users</a></li><li><a href="/explanations/permissions/" class="sidebar-link">Permissions Explained</a></li><li><a href="/explanations/cellular-data-usage/" class="sidebar-link">Cellular Data Usage</a></li><li><a href="/explanations/grouping-and-tagging/" class="sidebar-link">Tagging and Grouping</a></li><li><a href="/explanations/billing/" class="sidebar-link">Billing Explained</a></li><li><a href="/explanations/playbooks/" class="sidebar-link">Playbooks Explained</a></li><li><a href="/explanations/grafana/" class="sidebar-link">Grafana - Company Dashboard, Device Dashboard</a></li><li><a href="/explanations/alerts/" class="sidebar-link">Alerts Explained</a></li><li><a href="/explanations/2fa/" class="sidebar-link">Two-Factor Authentication</a></li><li><a href="/explanations/auditing-options/" class="sidebar-link">Auditing Explained</a></li><li><a href="/explanations/cant-connect-my-device/" class="sidebar-link">I cannot connect my device</a></li><li><a href="/explanations/adding-or-claiming-devices-in-bulk/" class="sidebar-link">Adding / Claiming devices in bulk</a></li><li><a href="/explanations/bunch-claiming-devices/" aria-current="page" class="active sidebar-link">Bunch Claiming Devices</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/explanations/bunch-claiming-devices/#claim-from-csv-file" class="sidebar-link">Claim from CSV file</a></li></ul></li><li><a href="/explanations/wadmp-ports/" class="sidebar-link">WADMP Ports / Addresses</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="bunch-claiming-devices"><a href="#bunch-claiming-devices" class="header-anchor">#</a> Bunch Claiming Devices</h1> <p>This topic is a tutorial for bunch claiming devices using API, Python scripts, and CSV files.</p> <h2 id="claim-from-csv-file"><a href="#claim-from-csv-file" class="header-anchor">#</a> Claim from CSV file</h2> <p>This script claims devices in the WADMP platform using a <em>CSV</em> file as input. It takes the following arguments:</p> <ul><li><strong>username</strong>: the username for the WADMP account</li> <li><strong>password</strong>: the password for the WADMP account</li> <li><strong>csv</strong>: the name of the CSV file (located in the &quot;resources&quot; folder) containing the device information</li> <li><strong>company_id</strong>: the ID of the company to which the devices will be claimed</li> <li><strong>out file</strong> (for errors): the name of the file to which error messages will be written</li></ul> <p>It imports the following modules:</p> <ul><li><strong>sys</strong>: used to access command line arguments</li> <li><strong>os.path</strong>: used to check if a file exists</li> <li><strong>requests</strong>: used to make API calls</li> <li><strong>time</strong>: used to get the current time</li> <li><strong>os</strong>: used to check if a file exists</li> <li><strong>dmp.ApiConsumer</strong>: a custom module used to interact with the WADMP API</li> <li><strong>dmp.Methods</strong>: a custom module used to handle errors</li> <li><strong>csv</strong>: used to read the CSV file</li></ul> <p>CSV input file parameters:</p> <ul><li><strong>SERIAL</strong> - REQUIRED</li> <li><strong>MAC</strong> - REQUIRED</li> <li><strong>IMEI</strong> - OPTIONAL</li> <li><strong>ALIAS</strong> - OPTIONAL (if not filled, it will be used MAC as ALIAS)</li></ul> <hr> <p>Description of the process:</p> <p>The script first checks that the correct number of arguments were passed and exits with an error message if not. It then logs into the WADMP platform using the provided username and password.</p> <p>The script then defines a function &quot;<em>append_file</em>&quot; to write error messages to the specified out file. First, it checks if the file exists and, if not, creates it. It then reads the existing lines of the file and removes any newline characters from the end. It then appends the error message to the file, including the <em>MAC address</em> and the error message from the API response.</p> <p>The script reads the <em>CSV</em> file using the &quot;csv&quot; module and iterates through each row, extracting the <em>MAC</em>, <em>serial</em>, <em>IMEI</em>, and <em>alias</em> information. It then creates a dictionary containing this information and the <em>company_id</em>. It then calls the WADMP API to claim the device, and if the API returns an error, it prints the error message and calls the &quot;<em>append_file</em>&quot; function to write the error to the out file. On the other hand, if the API call is successful, it simply prints a message indicating success.</p> <hr> <p>📝 <strong>Note:</strong> For this script is necessary DMP library that can be obtained by running the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>pip3 install https://bitbucket.org/bbsmartworx/dmp-public/raw/
8e86aa752b921caa095d8791cc8f6af62e2d7087/python_scripts/lib/dist/dmp-1.0.0.tar.gz
</code></pre></div><p>After this step you should be able to see the library installed by the command pip3 list:</p> <p><img src="/assets/img/pip3_list.9af6ed9b.png" alt="pip3 list" title="pip3 list"></p> <hr></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/wadmp/wadmp.github.io/edit/master/explanations/bunch-claiming-devices/README.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/27/2023, 2:04:10 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/explanations/adding-or-claiming-devices-in-bulk/" class="prev">
        Adding / Claiming devices in bulk
      </a></span> <span class="next"><a href="/explanations/wadmp-ports/">
        WADMP Ports / Addresses
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.4d4f93c9.js" defer></script><script src="/assets/js/2.8d7a74f5.js" defer></script><script src="/assets/js/12.4f642c83.js" defer></script><script src="/assets/js/28.3842130a.js" defer></script>
  </body>
</html>
